<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

		<title>Hardware Atlases</title>

		<meta name="description" content="HaxePunk is a 2d game engine written in Haxe for cross-platform deployment.">
		<meta name="author" content="HaxePunk.com">
		<meta name="HandheldFriendly" content="True">
		<meta name="MobileOptimized" content="320">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

		<link rel="shortcut icon" type="image/png" href="http://haxepunk.com/img/favicon.png">

		<link rel="stylesheet" type="text/css" href="http://haxepunk.com/css/ink.css">
		<link rel="stylesheet" type="text/css" href="http://haxepunk.com/css/syntax.css">
		<link rel="stylesheet" type="text/css" href="http://haxepunk.com/css/custom.css">

		<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-5069201-6', 'haxepunk.com');
		ga('send', 'pageview');
		</script>
	</head>

	<body>
		<div class="top-menu">
			<a href="http://haxepunk.com/" class="logo">
				<image src="http://haxepunk.com/img/HaxePunk.svg" width="300" height="75" alt="HaxePunk" />
			</a>
			<nav class="ink-navigation">
				<ul class="menu horizontal orange">
					<li class="">
						<a href="http://haxepunk.com/">Home</a>
					</li>
					<li class="">
						<a href="http://haxepunk.com/features/">Features</a>
					</li>
					<li class="">
						<a href="http://haxepunk.com/demos/">Demos</a>
					</li>
					<li class="active">
						<a href="http://haxepunk.com/documentation/">Documentation</a>
					</li>
					<li class="">
						<a href="http://haxepunk.com/games/">Games</a>
					</li>
					<li>
						<a href="http://forum.haxepunk.com/">Forum</a>
					</li>
				</ul>
			</nav>
		</div>

		<div class="github">
			<a href="https://github.com/HaxePunk/HaxePunk">Fork me on GitHub</a>
		</div>

<div class="ink-grid vspace mainpoints">
	<h1>Hardware Atlases</h1>

<p>One of the major differences between HaxePunk and FlashPunk is that it runs on multiple platforms. Many of these platforms work differently than Flash/HTML5 which uses buffer rendering with BitmapData objects. On desktop and mobile targets HaxePunk uses hardware acceleration through OpenGL which use Atlas objects. The reason for this is buffer rendering is simply too slow native targets.</p>

<h3>Atlas Classes</h3>

<p>Imagine an Atlas as an image with multiple regions cut out of it. If you&#39;ve worked on mobile you may be familiar with texture packing. This is essentially the same concept except each type of Atlas class sees the texture in different ways.</p>

<dl>
    <dt>TileAtlas</dt>
    <dd>Defines regions based on columns and rows</dd>
    <dd>Get regions by tile index</dd>

    <dt>TextureAtlas</t>
    <dd>Defines regions based on a TexturePacker xml format</dd>
    <dd>Get regions by name</dd>

    <dt>BitmapTextAtlas</dt>
    <dd>Based off TextureAtlas but used for the BitmapText graphic</dd>

    <dt>Atlas</t>
    <dd>Defines the entire image as a single region</dd>
</dl>

<p>TileAtlas and TextureAtlas return AtlasRegion objects, using getRegion(), that define a rectangular section of the image. Each AtlasRegion contains a reference to an AtlasData object and the rectangular area to draw. A region can also be clipped which makes a copy of the AtlasRegion containing a new rectangular area.</p>

<h3>AtlasData</h3>

<p>AtlasData stores draw calls for an individual texture. Since it is better to only have a single AtlasData for each texture we keep a pool of AtlasData objects. This also handles special rendering flags such as transparency, tinting, and blending. So blending is specific to a texture and not an object, like it is in Flash. Here&#39;s an example:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kd">var</span> ad <span class="o">=</span> <span class="n">AtlasData</span><span class="p">.</span><span class="n">getAtlasDataByName</span><span class="p">(</span><span class="s2">&quot;assets/graphics/mytexture.png&quot;</span><span class="p">);</span>
<span class="n">ad</span><span class="p">.</span><span class="n">blend</span> <span class="o">=</span> <span class="n">AtlasData</span><span class="p">.</span><span class="n">BLEND_NONE</span><span class="p">;</span> <span class="c1">// no blending</span>
<span class="n">ad</span><span class="p">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// turn off transparency</span>
</code></pre></div>
<p>If you&#39;re looking for a way to increase performance, turning off blending and alpha on images will help. This is a global change so use it on images like tilemaps that might not need transparency.</p>

<p>AtlasData also handles sprite batching so that OpenGL isn&#39;t flooded with draw calls. Any time a texture or layer changes the AtlasData object is flushed and rendering continues.</p>

<h3>Just Give Me Buffer Rendering!</h3>

<p>If you&#39;re not happy with hardware rendering, or have used BitmapData to do some fancy effects, you can force HaxePunk to use buffer rendering. This is not suggested for mobile devices as you will most likely get around 5fps, if you&#39;re lucky.</p>

<p>You can set buffer rendering on initialization like this:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">RenderMode</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Engine</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">MyEngine</span> <span class="kd">extends</span> <span class="n">Engine</span>
<span class="p">{</span>
    <span class="kd">function</span> <span class="nf">new</span><span class="p">(</span><span class="n">rate</span><span class="p">:</span><span class="n">Int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">fixed</span><span class="p">:</span><span class="n">Bool</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// width/height set to zero to automatically fill the window</span>
        <span class="n">super</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">RenderMode</span><span class="p">.</span><span class="n">BUFFER</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Or you can toggle between the different modes like this:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="c1">// set to buffer mode</span>
<span class="n">HXP</span><span class="p">.</span><span class="n">renderMode</span> <span class="o">=</span> <span class="n">RenderMode</span><span class="p">.</span><span class="n">BUFFER</span><span class="p">;</span>
<span class="c1">// set to hardware mode</span>
<span class="n">HXP</span><span class="p">.</span><span class="n">renderMode</span> <span class="o">=</span> <span class="n">RenderMode</span><span class="p">.</span><span class="n">HARDWARE</span><span class="p">;</span>
</code></pre></div>
<p><em>Note: This mode is not guaranteed to work in all cases as there are some minor differences between OpenFL and Flash.</em></p>

</div>


		<footer>
		<div class="ink-grid">
		   <div class="large-100 medium-100 small-100">
				Copyright &copy; 2011-2016 HaxePunk.com
				&bull;
				HaxePunk's <a href="https://github.com/HaxePunk">code</a> is licensed under
				<a href="http://opensource.org/licenses/MIT">MIT</a>
				&bull;
				Follow <a href="https://twitter.com/HaxePunk">@HaxePunk</a>
				&bull;
				<a href="https://github.com/HaxePunk/haxepunk.com">Site</a> made with <a href="http://ink.sapo.pt/">Ink</a>
				Powered by <a href="http://pages.github.com/">GitHub Pages</a>
			</div>
		</div>
		</footer>

		<script type="text/javascript" src="http://haxepunk.com/js/holder.js"></script>
		<script type="text/javascript" src="http://haxepunk.com/js/ink-all.min.js"></script>
		<script type="text/javascript" src="http://haxepunk.com/js/autoload.js"></script>
		<script type="text/javascript" src="http://haxepunk.com/js/html5shiv.js"></script>
	</body>

</html>
