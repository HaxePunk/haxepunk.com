<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

		<title>Handling Collisions</title>

		<meta name="description" content="HaxePunk is a 2d game engine written in Haxe for cross-platform deployment.">
		<meta name="author" content="HaxePunk.com">
		<meta name="HandheldFriendly" content="True">
		<meta name="MobileOptimized" content="320">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

		<link rel="shortcut icon" type="image/png" href="/img/favicon.png">

		<link rel="stylesheet" type="text/css" href="/css/ink.css">
		<link rel="stylesheet" type="text/css" href="/css/syntax.css">
		<link rel="stylesheet" type="text/css" href="/css/custom.css">

		<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-5069201-6', 'haxepunk.com');
		ga('send', 'pageview');
		</script>
	</head>

	<body>
		<div class="top-menu">
			<a href="/" class="logo">
				<image src="/img/HaxePunk.svg" width="512" height="128" alt="HaxePunk" />
			</a>
			<nav class="ink-navigation">
				<ul class="menu horizontal orange">
					<li class="">
						<a href="/">Home</a>
					</li>
					<li class="">
						<a href="/features/">Features</a>
					</li>
					<li class="">
						<a href="/demos/">Demos</a>
					</li>
					<li class="active">
						<a href="/documentation/">Documentation</a>
					</li>
					<li class="">
						<a href="/games/">Games</a>
					</li>
					<li>
						<a href="http://forum.haxepunk.com/category/1/blog">Blog</a>
					</li>
					<li>
						<a href="http://forum.haxepunk.com/">Forum</a>
					</li>
				</ul>
			</nav>
		</div>

		<div class="github">
			<a href="https://github.com/HaxePunk/HaxePunk">Fork me on GitHub</a>
		</div>

<div class="ink-grid vspace mainpoints">
	<h1>Handling Collisions</h1>

<p>One of the most useful things to be able to do in a game is make Entities interact with each other in different ways, and HaxePunk has a set of useful collision functions for this purpose that will be explained in this tutorial.</p>

<h2>Assigning Hitboxes</h2>

<p>HaxePunk uses rectangles for all base-level collision between Entities. You define a rectanular collision area for your Entity, called its <strong>hitbox</strong>, and then you can use HaxePunk&#39;s functions to test if an Entity&#39;s hitbox intersects with anothers&#39;. So if we have an Entity called <strong>Player</strong>, in it we can define hitbox parameters like this:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">import</span> <span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Player</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">();</span>

        <span class="c1">// Here I set the hitbox width/height with the setHitbox function.</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>

        <span class="c1">// Here I do the same thing by just assigning Player&#39;s properties.</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
        <span class="n">height</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>I set the hitbox values two different ways here. Both ways work the same, so you can do it whichever way you prefer. Now that we have one Entity with a 50x50 hitbox, let&#39;s create another Entity to collide with our Player object. We&#39;ll call our other Entity <strong>Bullet</strong>, and then we&#39;ll check to see if Player is colliding with it.</p>

<p>So our Bullet Entity will look like this:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">import</span> <span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Bullet</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">();</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>Collision Types</h2>

<p>So we created the bullet Entity and gave it a 10x10 hitbox, but there&#39;s one more line we need to add before we can check if they intersect:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">import</span> <span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Bullet</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">();</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
        <span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;bullet&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Here, I assign a type to the Bullet Entity, and give it the value &quot;bullet&quot;¬ù. What this does is categorizes the object under the &quot;bullet&quot; type in HaxePunk, because when you want to check for collision against another Entity, you have to provide a type to check against.</p>

<blockquote>
<p>Entity types must be a string value, and do not have to share a name with their corresponding object. You could have multiple different Classes all under the &quot;solid&quot; type, but keep in mind that type-checking is case-sensitive (eg. &quot;solid&quot; is not the same as &quot;Solid&quot; or &quot;SOLID&quot;). So when a Bullet instance is added to the Scene, it will be added to the &quot;bullet&quot; group.</p>
</blockquote>

<p>In the next step, I&#39;ll show you how to check if our Player is colliding with a Bullet object by using this assigned type.</p>

<h2>Colliding Entities</h2>

<p>Now that we have our Bullet Entity classified under the &quot;bullet&quot; group, we can go back to our Player and use Entity&#39;s handy collide() function to check if our Player is intersecting with any instances of the &quot;bullet&quot; type in the Scene:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">import</span> <span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Player</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">();</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">collide</span><span class="p">(</span><span class="s2">&quot;bullet&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Player is colliding with a &quot;bullet&quot; type.</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>So here, we use collide() to check if the Player will collide with any &quot;bullet&quot; objects when placed at its current location (x, y). If you wanted to check 10 pixels ahead, you could do so as well:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">import</span> <span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Player</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">();</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">collide</span><span class="p">(</span><span class="s2">&quot;bullet&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Player will intersect a &quot;bullet&quot; at (x + 10, y).</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>But HaxePunk also supports more specific collision behavior as well. Let&#39;s say we created our Bullet with a function to destroy the Entity, removing it from the Scene, like so:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">import</span> <span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">haxepunk</span><span class="p">.</span><span class="nn">HXP</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Bullet</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">();</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
        <span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;bullet&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">destroy</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Here we could place specific destroy-behavior for the Bullet.</span>
        <span class="n">scene</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>So now, what if we want the Bullet to be destroyed when the Player collides with it? For this, we can use the collide() function in Player again, and do this:</p>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">import</span> <span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Player</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">();</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kd">var</span> e<span class="p">:</span><span class="n">Entity</span> <span class="o">=</span> <span class="n">collide</span><span class="p">(</span><span class="s2">&quot;bullet&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kd">var</span> b<span class="p">:</span><span class="n">Bullet</span> <span class="o">=</span> <span class="k">cast</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Bullet</span><span class="p">);</span>
            <span class="n">b</span><span class="p">.</span><span class="n">destroy</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>This time, instead of putting collide() in the statement, we just assign its return value to a variable. What the collide() function will do is check the Scene for any intersecting instances of &quot;bullet&quot;, and if it finds one, it will return the value of that Entity object. If it doesn&#39;t find any intersections, it will return as null.</p>

<p>With this knowledge, we can then use that assigned variable in the if-statement, since the statement will only evaluate true for a non-null value. Then, I simply cast the entity to a Bullet type and call the Bullet&#39;s destroy() function.</p>

</div>


		<footer>
		<div class="ink-grid">
			<div class="large-100 medium-100 small-100">
				<strong>HaxePunk</strong> is an open source, cross-platform game engine for the <a href="http://haxe.org">Haxe programming language</a>.
			</div>
			<div class="large-100 medium-100 small-100">
				Copyright &copy; 2011-2018 HaxePunk.com
				&bull;
				HaxePunk's <a href="https://github.com/HaxePunk">code</a> is licensed under
				<a href="http://opensource.org/licenses/MIT">MIT</a>
				&bull;
				Follow <a href="https://twitter.com/HaxePunk">@HaxePunk</a>
				&bull;
				<a href="https://github.com/HaxePunk/haxepunk.com">Site</a> made with <a href="http://ink.sapo.pt/">Ink</a>
				Powered by <a href="http://pages.github.com/">GitHub Pages</a>
			</div>
		</div>
		</footer>

		<script type="text/javascript" src="/js/holder.js"></script>
		<script type="text/javascript" src="/js/ink-all.min.js"></script>
		<script type="text/javascript" src="/js/autoload.js"></script>
		<script type="text/javascript" src="/js/html5shiv.js"></script>
	</body>

</html>
