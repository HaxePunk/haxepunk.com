<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

		<title>A Simple Shooter</title>

		<meta name="description" content="HaxePunk is a 2d game engine written in Haxe for cross-platform deployment.">
		<meta name="author" content="HaxePunk.com">
		<meta name="HandheldFriendly" content="True">
		<meta name="MobileOptimized" content="320">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

		<link rel="shortcut icon" type="image/png" href="http://haxepunk.com/img/favicon.png">

		<link rel="stylesheet" type="text/css" href="http://haxepunk.com/css/ink.css">
		<link rel="stylesheet" type="text/css" href="http://haxepunk.com/css/syntax.css">
		<link rel="stylesheet" type="text/css" href="http://haxepunk.com/css/custom.css">

		<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-5069201-6', 'haxepunk.com');
		ga('send', 'pageview');
		</script>
	</head>

	<body>
		<div class="top-menu">
			<a href="http://haxepunk.com/" class="logo">
				<image src="http://haxepunk.com/img/HaxePunk.svg" width="300" height="75" alt="HaxePunk" />
			</a>
			<nav class="ink-navigation">
				<ul class="menu horizontal orange">
					<li class="">
						<a href="http://haxepunk.com/">Home</a>
					</li>
					<li class="">
						<a href="http://haxepunk.com/features/">Features</a>
					</li>
					<li class="">
						<a href="http://haxepunk.com/demos/">Demos</a>
					</li>
					<li class="active">
						<a href="http://haxepunk.com/documentation/">Documentation</a>
					</li>
					<li class="">
						<a href="http://haxepunk.com/games/">Games</a>
					</li>
					<li>
						<a href="http://forum.haxepunk.com/">Forum</a>
					</li>
				</ul>
			</nav>
		</div>

		<div class="github">
			<a href="https://github.com/HaxePunk/HaxePunk">Fork me on GitHub</a>
		</div>

<div class="ink-grid vspace mainpoints">
	<h1>A Simple Shooter</h1>

<p>Now that we know how to add entities to the scene and move them around we can learn about collisions. This tutorial will cover how to make a simple space shooter with enemies. I will also talk a little about game prototyping.</p>

<p>Let&#39;s start out with a Ship class which holds the basic mechanics for our game.</p>

<h3>src/entities/Ship.hx</h3>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">package</span> <span class="nn">entities</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">HXP</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">graphics</span><span class="p">.</span><span class="nn">Image</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">Input</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">utils</span><span class="p">.</span><span class="nn">Key</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Ship</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="n">Float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="n">Float</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>

        <span class="n">graphic</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="n">createRect</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mh">0xDDEEFF</span><span class="p">);</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>

        <span class="n">Input</span><span class="p">.</span><span class="n">define</span><span class="p">(</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Key</span><span class="p">.</span><span class="n">UP</span><span class="p">,</span> <span class="n">Key</span><span class="p">.</span><span class="n">W</span><span class="p">]);</span>
        <span class="n">Input</span><span class="p">.</span><span class="n">define</span><span class="p">(</span><span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Key</span><span class="p">.</span><span class="n">DOWN</span><span class="p">,</span> <span class="n">Key</span><span class="p">.</span><span class="n">S</span><span class="p">]);</span>

        <span class="n">velocity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;player&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">function</span> <span class="nf">handleInput</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">acceleration</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;up&quot;</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">acceleration</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;down&quot;</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">acceleration</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">function</span> <span class="nf">move</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">velocity</span> <span class="o">+=</span> <span class="n">acceleration</span> <span class="o">*</span> <span class="n">speed</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">abs</span><span class="p">(</span><span class="n">velocity</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxVelocity</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">velocity</span> <span class="o">=</span> <span class="n">maxVelocity</span> <span class="o">*</span> <span class="n">HXP</span><span class="p">.</span><span class="n">sign</span><span class="p">(</span><span class="n">velocity</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">velocity</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">velocity</span> <span class="o">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">min</span><span class="p">(</span><span class="n">velocity</span> <span class="o">+</span> <span class="n">drag</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">velocity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">velocity</span> <span class="o">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">max</span><span class="p">(</span><span class="n">velocity</span> <span class="o">-</span> <span class="n">drag</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">handleInput</span><span class="p">();</span>
        <span class="n">move</span><span class="p">();</span>
        <span class="n">moveBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">velocity</span><span class="p">);</span>
        <span class="n">super</span><span class="p">.</span><span class="n">update</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">var</span> velocity<span class="p">:</span><span class="n">Float</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kd">var</span> acceleration<span class="p">:</span><span class="n">Float</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">inline</span> <span class="kd">var</span> maxVelocity<span class="p">:</span><span class="n">Float</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">inline</span> <span class="kd">var</span> speed<span class="p">:</span><span class="n">Float</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">inline</span> <span class="kd">var</span> drag<span class="p">:</span><span class="n">Float</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>This should look very familiar to you since it is essentially the same code from the <a href="/documentation/tutorials/movement-and-animation/">Movement and Animation</a> tutorial. The one major difference is that we are using <code>Image.createRect</code> for the graphic. This will allow you to build out the mechanics without having to worry about graphics. I gave it a color so you can tell the difference between the enemies and the player.</p>

<p>The other addition to this class is the call to <code>setHitbox</code>. This adds a bounding box to your entity so that it can collide with other objects. I also set the type to &quot;player&quot; so that I can reference it by type later on.</p>

<p>An easy way to tell if you have your hitboxes setup correctly is to use the debug console. Build your project by typing in <code>lime test flash -debug</code> and you will see the console. Pressing tilde &quot;~&quot; by default will display all the entities hitbox outlines in the console. Handy!</p>

<p>Well, movement is great but we really need to add some action. Let&#39;s make a new class and call it Bullet. I think you know where we&#39;re going from here. :)</p>

<h3>src/entities/Bullet.hx</h3>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">package</span> <span class="nn">entities</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">graphics</span><span class="p">.</span><span class="nn">Image</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Bullet</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="n">Float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="n">Float</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>

        <span class="n">graphic</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="n">createRect</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
        <span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;bullet&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">moveCollideX</span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="n">Entity</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">scene</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="n">scene</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">moveBy</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;enemy&quot;</span><span class="p">);</span>
        <span class="n">super</span><span class="p">.</span><span class="n">update</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Pretty simple right? But what about the moveCollideX function you say? Well, that is simply called from the moveBy function any time there is a collision on the x axis. I added the type &quot;enemy&quot; to the moveBy function call to specify what type of entity to collide with.</p>

<p>So if you build this now, what happens? Nothing! Oh yeah... we need to create an instance of the bullet every time the player presses the shoot key. Drop this little snippet into the bottom of handleInput.</p>

<h3>src/entities/Ship.hx</h3>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe">    <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">pressed</span><span class="p">(</span><span class="s2">&quot;shoot&quot;</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">scene</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span> <span class="n">Bullet</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">));</span>
    <span class="p">}</span>
</code></pre></div>
<p>So cool! All you need now is some enemy ships and you&#39;ll have the start of an awesome game.</p>

<p>We&#39;re going to make another class called Enemy which is basically a Bullet in reverse. Note the difference in type and what it collides with.</p>

<h3>src/entities/Enemy.hx</h3>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">package</span> <span class="nn">entities</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Entity</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">graphics</span><span class="p">.</span><span class="nn">Image</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">Enemy</span> <span class="kd">extends</span> <span class="n">Entity</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="n">Float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="n">Float</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>

        <span class="n">graphic</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="n">createRect</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
        <span class="n">setHitbox</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
        <span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;enemy&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">moveCollideX</span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="n">Entity</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">scene</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="n">scene</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">moveBy</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;player&quot;</span><span class="p">);</span>
        <span class="n">super</span><span class="p">.</span><span class="n">update</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The Enemy class is done but we have no way of spawning new ones. So let&#39;s build a spawn timer in GameScene.</p>

<h3>src/scenes/GameScene.hx</h3>
<div class="highlight"><pre><code class="language-haxe" data-lang="haxe"><span class="kn">package</span> <span class="nn">scenes</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">Scene</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com</span><span class="p">.</span><span class="nn">haxepunk</span><span class="p">.</span><span class="nn">HXP</span><span class="p">;</span>

<span class="kd">class</span> <span class="n">GameScene</span> <span class="kd">extends</span> <span class="n">Scene</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">function</span> <span class="nf">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">super</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">begin</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">add</span><span class="p">(</span><span class="k">new</span> <span class="n">entities</span><span class="p">.</span><span class="n">Ship</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">HXP</span><span class="p">.</span><span class="n">halfHeight</span><span class="p">));</span>
        <span class="n">spawn</span><span class="p">();</span> <span class="c1">// create our first enemy</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">override</span> <span class="kd">function</span> <span class="nf">update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">spawnTimer</span> <span class="o">-=</span> <span class="n">HXP</span><span class="p">.</span><span class="n">elapsed</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">spawnTimer</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">spawn</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="n">super</span><span class="p">.</span><span class="n">update</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">function</span> <span class="nf">spawn</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kd">var</span> y <span class="o">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="n">HXP</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>
        <span class="n">add</span><span class="p">(</span><span class="k">new</span> <span class="n">entities</span><span class="p">.</span><span class="n">Enemy</span><span class="p">(</span><span class="n">HXP</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="p">));</span>
        <span class="n">spawnTimer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// every second</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">var</span> spawnTimer<span class="p">:</span><span class="n">Float</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Notice how the timer gets reset every time something spawns and counts down until the next one. Try adding in random spawn times just for fun. Experimenting with different values is the best way to learn.</p>

</div>


		<footer>
		<div class="ink-grid">
		   <div class="large-100 medium-100 small-100">
				Copyright &copy; 2011-2016 HaxePunk.com
				&bull;
				HaxePunk's <a href="https://github.com/HaxePunk">code</a> is licensed under
				<a href="http://opensource.org/licenses/MIT">MIT</a>
				&bull;
				Follow <a href="https://twitter.com/HaxePunk">@HaxePunk</a>
				&bull;
				<a href="https://github.com/HaxePunk/haxepunk.com">Site</a> made with <a href="http://ink.sapo.pt/">Ink</a>
				Powered by <a href="http://pages.github.com/">GitHub Pages</a>
			</div>
		</div>
		</footer>

		<script type="text/javascript" src="http://haxepunk.com/js/holder.js"></script>
		<script type="text/javascript" src="http://haxepunk.com/js/ink-all.min.js"></script>
		<script type="text/javascript" src="http://haxepunk.com/js/autoload.js"></script>
		<script type="text/javascript" src="http://haxepunk.com/js/html5shiv.js"></script>
	</body>

</html>
